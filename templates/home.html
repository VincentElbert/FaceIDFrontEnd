<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='page.css') }}"/>
  </head>
  <body>
    <div class="navbar">
      <div class="nav-items">
        <img src="static/menu-icon.png" alt="Hamburger Icon" class="icon" />
        <img src="static/face_defense_master_logo.png" alt="Web Logo" class="logo" />
      </div>
      <div class="nav-items">
        <img id="logout-nav" src="static/logout-icon.png" alt="Logout Icon" class="icon" />
        <img src="static/profile-icon.png" alt="Profile Icon" class="icon" />
        <p>{{username}}</p>
      </div>
    </div>

    <div class="sidebar">
      <div class="side-items">
        <div class="menu-item">Account</div>
        <div class="menu-item">Log-in History</div>
        <div class="menu-item">Connected Devices</div>
        <div class="menu-item">Connected Apps</div>
      </div>
      <div class="side-items">
        <div class="menu-item">Settings</div>
        <div id="logout-menu" class="menu-item">Logout</div>
      </div>
    </div>

    <div class="content">
      <div class="cards">

        <div id="connected-devices" class="card">
          <img id="connected-devices-expand" src="static/expand.png" alt="Expand Icon" class="expand-minimize icon" />
          <h2>Connected Devices</h2>
          <p>
            &emsp;Active Devices: ...
          </p>
          <p>
            &emsp;Total Connected Devices: ...
          </p>

          <div class="devices-container">
            <ul id="devices-list"></ul>
          </div>

        </div>

        <div id="connected-apps" class="card">
          <img id="connected-apps-expand" src="static/expand.png" alt="Expand Icon" class="expand-minimize icon" />
          <h2>Connected Apps</h2>
          <div class="apps-container">
            <div class="apps">Jira</div>
            <div class="apps">Teams</div>

            <div class="apps">+add apps</div>
          </div>
        </div>
        <div id="login-history" class="card full-row">
          <img id="login-history-expand" src="static/expand.png" alt="Expand Icon" class="expand-minimize icon" />
          <h2>Log-in History</h2>
          Device      Date & Time     Location      Event
        </div>
      </div>
    </div>
    <script>
      const connectionsData = JSON.parse('{{ connections|safe }}');
      const devicesList = document.getElementById('devices-list');
      connectionsData.forEach(connection => {
          const li = document.createElement('li');
          li.textContent = connection.device;
          devicesList.appendChild(li);
      });
      var logoutMenu = document.getElementById('logout-menu');
      var logoutNav = document.getElementById('logout-nav');
      
      var connectedDevicesExpand = document.getElementById('connected-devices-expand');
      var connectedAppsExpand = document.getElementById('connected-apps-expand');
      var loginHistoryExpand = document.getElementById('login-history-expand');
    
      logoutMenu.addEventListener('click', function() {
        window.location.href = "{{ url_for('logout') }}";
      });
      logoutNav.addEventListener('click', function() {
        window.location.href = "{{ url_for('logout') }}";
      });

      connectedDevicesExpand.addEventListener('click', function(){

      });
    </script>
  </body>
</html>
